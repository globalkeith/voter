defmodule Voter do
  def main do
    input = "0000000000000000000000000000002010000000000000000001020000000000020010001000100000100000000000000000
1000000020000100000000000000001000200000000000000000000000000002010000000000000000000000000000000000
0001020000000020000000000000000000000000002001002000020000000000000200020000000000000000000000000020
0000000000000021000000000002020100001000000000020200000000000002020000000000001002000000000200020001
0000000000000000000000000000000000000000000020000000002200000100000000000200011000100000020020100000
0010000000000000000000000100000002110000000200002000000001000000000000002000000000000020000000000000
0000000020000000201000000000000000000000010000000000000001000000202000000000000012000000000000100000
0100000000001000200000000000000000000000000001000000000000000000000000001000002000000100000000000000
0000000001020000100100100000000000000000000000000002000000000000000000000000000000000202000000002000
2000000000000010000000000000000000000200000100000002200020000120000200000000000000000200000010002000
1000000120000000000002000000010000000210000020000000000000010000000002002000020000000000010001000000
0011000000000000000000000000200000000000000100000010011000000001010000000000000200000200000100020000
0002200102000000001000000002000200000000000000000000000000000000000000000200000020000200000000000000
0100000000000000000000000000010000000000000010000020000000000000000000000000020000000002000000000000
1001002002020000000010002000010020000000000200000000000000020000000000000000000000000001000000000000
0000220000000000000000000000000000000000000100000001000000001000201200000000000010000020000020000100
0211100000000000001000000200021001000200000001000000000000000000011000100102000200200200000000012000
0000000000120000000000000000000000000000000000000000000001000010000000000000000000000000000000000000
0001001110000000001200000000000000000000010000000001000000000020001000000000001000000000012000000000
1000200010000000000001000200000200000200000000001000000000000000000100000200200100000000000000000000
0000000000000020000000200000200200000000000020000000000002000000000000000000000000000000000001000000
0002200000000100000000010000000000001000000000120000200000000000200000020000000000000000011000000000
0000000000000001200000000000000000000000000000000000000000000000000100000000000000000000000000000000
0002000101000000000000000000200000000000100000000000000000000000000000000000000000002000000000000000
0000000200000000000000000000000200000000000000000000000000002010000000000000002000000000000000000000
0000000020000000000000000000000010000000000000000000010000020200000000000000000000001000000000010000
0021002001000000000000002000000000000000000000211000000100000002000000000000000000000002110000000000
0000000000000000000000000002000000000000001000000000000000000200000000000102000000000000000000000000
0000000000000002000000000000000000000000000000000000000000000000010000010000021000000000000000000000
0000201020000001000000100000000001000000000000000000020000000000000000100000010000000010000000000000
0020000000000000000000000000000020000010000001000000100000000000020000000002000000000000000000000000
0000000200000000000000000000000000001000000000000000000000000020000000000000000000000000000000000000
0020000000200000000000000020202012000000000102000000000000000000000002000020000000100000001000000200
2000000000000002001000000000000021000000000000000000000021020210010000000000000000000000000000002001
0000000000000110000100000000000000000002000000000000001000000000020000000000000000000100100000001000
0000000100010000020100000000100000000000000000000000000000200120000000000000000000000000001000000002
0000000001000200000002000000000001002000000000000000200000100000011000000002000000000000000000000000
0000000010120000000000000000000001001000000000000200020000100001001012200000000001020000000000200000
0001000020000000000000000000000000000000200000000100000000000000200000000000000000000000100001001000
0001000000000000100200000000000200000000110001000000000000000000000000010000000000000000010010000000
0010000020000200000100000000000000000000000000002000000000000000001000000000000000002102000000010000
0000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000001
0000000000000020000022000000010000000000000000000001000002000020000000100100000000000000000002000000
0200001000001001020010000000000020000020001010200000000000000000000010000000000000000000001000000200
1010000001000000000200000000002000000020000000000002000001000010000000000000000000000200000200100000
0000000000000000000000000000000000000200000000000020000000000000000000000000020002000000010000000000
1000000022000001000010000200000000000000020020000000100020000000010000000000010000000000000000220000
0000200000000100000020000000000000010000000112010100010000010000010000200000000000000000000000000000
0020010002002000000000000000020000002000000000000000000000000100000000000001020000000000000000000100
0000000000000000000000000000020020000000021000000000000020020000020000000000000000010000000100000020
0000002022020000000000000000101100100000000000000000002000000100000000000000000000000000000000000100
0000000000000000000000100000020000000000200202100000000000200000000000001000000000000001000010000000
2000000000010010000000000000000000000000000000000000000000202100100200000000000000000000000001000000
0000000000020000100000000000001000000100000000000200000000000000000000000000000000000000000000000000
0002020000000000000000000000000000000000000000000000100000000010000000000000001001000000010000000000
0000000000000200000000000020000000000100000000012000002000000010000000000001000120000200000000000101
0000000001000000020000000000010110000001000000000000000000000010000000000000000000000000000002000200
1000000000000000000000002000100000000000002000000000000000001000200000000000000000000200100000000000
2000000000000020202000000000000020000000000000000000000000020000202000200000000000000000000000000002
0201000000000001000000020100000000000000000010000000001000000000010000200000000000002000000010000000
0010000000000010000001000001000200000000000010000000000200000200010000000000200200000000000000000000
0000002001200000000000000000000000000200100001000000000000000000000000000000000001001000000000000000
0000000000000020000000000000000100000100000000010000000000002000000000000010020000000000120000200000
0000200020000000000200000000002001000000000000000000000000000002002000000000000000000100000001020000
0000000001000000002000100000100001000000000000000000000000000000000000000000200000000000200000000200
0000000200000000200202000000000000000010100000000000000000000000000000001000002000001000000000021000
0000000001000000000202000000010000000000000000200000000000000020000002020000000000000000000000102000
0000210010000000000012020000000200000000200000000000000200000100000000000010000000000000000000000000
0000000000000100000000000001011022000120000000000001000000100000000000000000000000200000000000100020
0000200000000001000000000000000000000000000000010000000000000002000000000000000000000000000020000000
0000200000000010000000000002000001201001000000011000000000000000001000010000000000002000000000100200
0000000000000000000000000000000010000000000000020000000000000000000011000000000000000000000000100201
0000000002001000000020202100000000000002000000000000000000100002000000000021000200000000001000010010
0000000002000000000020000000000000000000020000002002000000000000002001010000200000000000000000020000
0000000000002000001000000000200000000000100000002000000001000020000000100000000000000010000001000000
2100000010200000000200000000000000000000000000000001000000000001000000000000000000000000020000000000
0000000101000000000000000000000000000000000000001000000000000000100000000200010000200000000000000000
2000020000000002010000020010000000000000000000000000002001000002000100000000000000010000000000000000
0000200000001000001000000000200000000000100000000000010010100000000002000000011000000000000000000001
1000002000000000000000000000000000000000020000000000000000000000000001000200000000000000200000000020
0000020000000000000000000000000000000000020000000000000020000000000000020000000001010010000000000000
0000000000010100000022000000000000000000000000201000000000022000000000000000000011021100000000200000
0000000010001000020000202100002000000000000000000000000000000000020020000000001000000002001000010020
0000020100000000000000000000000000220200000000000002000000002000000010000000000000000020010000000000
1000000000000000000000000010000000000000210000000000100000000000000000000012000100000102001000001000
2000000020000000000000201000000220000000000200000000000000200000100000010000000000120000000000000000
0002200200000000000100000200000000100000000000000000000200000000100000010000000000000000000000100000
0000010000000000002001000200000010000000000000010012000010000000000000000000200002000000000000000000
0000000000002000200000000000000001000002000000000000000000000200000000000000000020100000010200000100
1020000000000000000000220000000000000000000002000000000010000020001000000120000000000200000002020000
0000100000000000020000021000002000000000000000000000000000000000000000000002000000000000000000000001
0220100001010020000100001000000000020000000000000000000000000000000020001000000000100000000010000001
2000000010000021000000200100000000000001000000000000000000000000020020000200000100000020200000000002
0000000000100000000000000002210000000000000010000000100000000000000000010000000000000000000100000021
0000001000000000000000200000000000000000000000100000200010000000200000000000000002000000000000200002
0000000000010100000000000000000010000000001000020000000000101010000001000002020200102000000010002000
0000210020020000000000100000000200000000002000200000000000000200001000000000000000000010000000200000
0000000000000000010000000001000000000001000000000000000000010010000000000000000000010000000000000000
0220000000000000000000000200000000000000002000000000000000000000000000100000000000000000000000000000
0000000002020000100000000000000000000000000002020000000000000000100000000000000000010100020000010001"

    :random.seed(:os.timestamp)

    keywords = input |> Voter.parse
      |> Voter.Jerry.gerrymander({100, 100}, 10)
      |> Enum.with_index
      |> Enum.flat_map(fn({{map, _winner}, index}) ->
        map |> Map.to_list
          |> Enum.map(fn({pos, _vote}) -> {pos, index} end)
      end)

    result = 0..100 |> Enum.flat_map(fn(x) ->
      (0..100 |> Enum.map(fn(y) ->
        keywords[{x, y}] |> to_string
      end)) ++ ["\n"]
    end) |> Enum.join

    IO.puts result
  end

  def parse(string) do
    string |> String.split("\n")
      |> Enum.map(fn(substring) ->
        substring |> String.strip
          |> String.split("")
          |> Enum.filter_map(&(&1 != ""), fn(char) ->
            case char do
              "0" ->
                0
              "1" ->
                1
              "2" ->
                -1
              _ ->
                throw "Something went wrong"
            end
          end)
          |> Enum.with_index
      end)
      |> Enum.with_index
      |> Enum.reduce(%{}, fn({list, y}, accum) ->
        list |> Enum.reduce(accum, fn({val, x}, acc) ->
          Map.put(acc, {x, y}, val)
        end)
      end)
  end
end
